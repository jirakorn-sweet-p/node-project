<main>
    <div class="main">
        <div class="header-main">
            <h2>สถานประกอบการที่เคยรับฝึกงาน</h2>
            <div class="sort">
                <select id="sort" onchange="handleSortChange(this)">
                    <option disabled value="0">จัดเรียงตาม</option>
                    <% if (sort == '1') { %>
                        <option selected value="1">ชื่อสถานที่ฝึกงาน ก-ฮ</option>
                    <% } else { %>
                        <option value="1">ชื่อสถานที่ฝึกงาน ก-ฮ</option>
                    <% } %>
                    <% if (sort == '2') { %>
                        <option selected value="2">ชื่อสถานที่ฝึกงาน ฮ-ก</option>
                    <% } else { %>
                        <option value="2">ชื่อสถานที่ฝึกงาน ฮ-ก</option>
                    <% } %>
                    <% if (sort == '3') { %>
                        <option selected value="3">จังหวัด ก-ฮ</option>
                    <% } else { %>
                        <option value="3">จังหวัด ก-ฮ</option>
                    <% } %>
                    <% if (sort == '4') { %>
                        <option selected value="4">จังหวัด ฮ-ก</option>
                    <% } else { %>
                        <option value="4">จังหวัด ฮ-ก</option>
                    <% } %>
                </select>
            </div>

            <div class="search">
                <input type="text" placeholder="ค้นหา" id="searching" oninput="filterTable()">
            </div>
        </div>
        <% var ojb = all_companies.sort((a, b) => a.name.localeCompare(b.name)) %>
                    <% if (sort == 2) { %>
                        <% var ojb = all_companies.sort((a, b) => a.name.localeCompare(b.name)).reverse() %>
                    <%} else if (sort == 3) { %>
                        <% ojb = all_companies.sort((a, b) => a.province.localeCompare(b.province)) %>
                    <%} else if (sort == 4) { %>
                        <% ojb = all_companies.sort((a, b) => a.province.localeCompare(b.province)).reverse() %>
                    <% } %>
        <div class="table">
            <table class="styled-table" id="styled-table">
                <thead>
                    <tr>
                        <th>สถานประกอบการ</th>
                        <th>เบอร์โทรศัพท์ สถานประกอบการ</th>
                        <!-- <th>ประเภทธุรกิจ</th> -->
                        <th class="on-left">จังหวัด</th>
                        <th>ตำแหน่งที่เคยรับ</th>
                        <th>จำนวนคนที่ฝึก</th>
                    </tr>
                    <% if (ojb.length == 0) { %>
                        <tr class="no-data">
                           <th colspan="8">
                               ไม่มีข้อมูล
                           </th>
                       </tr>
                       <% } %>
                    <tr class="no-data close" id="search-not-found">
                        <th colspan="8">
                            ไม่มีข้อมูล
                        </th>
                    </tr>
                </thead>
                <tbody>

                    <% ojb.forEach((element,index) => { %>
                        <tr>
                           <td><%= element.name %></td>
                           <td><%= element.tel %></td>
                           <!-- <td>บัญชี / ผู้ตรวจบัญชี</td> -->
                           <td class="on-left"><%= element.province %></td>
                           <td class="position2">
                               
                               <% if (all_position[index]) { %>
                                   <% all_position[index].forEach(element2 => { %>
                                   <div class="backend">
                                   <%= element2 %>
                                   </div>
                                   <% }) %>
                               <% } %>
                               
                           </td>
                           <td><%= intern.filter(value => value === element._id.toString()).length %></td>
                       </tr>
                       <% }) %>
                </tbody>
            </table>
        </div>
        <div class="paginator">

            <% for( let index=1; index <=all_pages2; index++ ) { %>
                <% if (index==current2) { %>
                    <a href="?page2=<%= index %>&sort=<%= sort %>" class="current-page">
                        <%= index %>
                    </a>
                    <% } else { %>
                        <a href="?page2=<%= index %>&sort=<%= sort %>">
                            <%= index %>
                        </a>
                        <% } %>
                            <% } %>
            
                    </div>


    </div>
</main>